function Csp(){var t=function(t,n){this.name=t,this.domain=n};t.prototype.toString=function(){return""+this.name+" => ["+this.domain.toString()+"]"};var n=function(t,n){this.fn=n,this.variables=t};n.prototype.toString=function(){return"("+this.variables.toString()+") => "+this.fn.toString()};var r=function(){this.solver=new e,this.variables={},this.constraints=[]};r.prototype.addVariable=function(n,r){this.variables[n]=new t(n,r)},r.prototype.changeVariable=function(t,n){if(!this.variables[t])throw new Error("Attempted to change a nonexistant variable.");this.variables[t].domain=n},r.prototype.addConstraint=function(t,r){0!=t.length&&this.constraints.push(new n(t,r))},r.prototype.setSolver=function(t){this.solver=t},r.prototype.getSolution=function(){return this.solver.getSolution(this)},r.prototype.getSolutions=function(){return this.solver.getSolutions(this)},r.prototype.getSolutionIter=function(){return this.solver.getSolutions(this)};var e=function(){};return e.prototype.getSolution=function(t){var n={};return this.solve(n,t.variables,t.constraints,!0)?n:{}},e.prototype.getSolutions=function(t){return this.allAssignments=[],this.solve({},t.variables,t.constraints,!1),this.allAssignments},e.prototype.getSolutionIter=function(t){throw{error:"Unsupported",message:"RecursiveBacktrackingSolver does not support a solution iterator"}},e.prototype.solve=function(t,n,r,e){function o(t){return angular.copy(t)}function i(n,e){t[n.name]=e;for(var o in r){args=[];var i=!0;for(var a in r[o].variables){var s=r[o].variables[a];if("undefined"==typeof t[s]){i=!1;break}args.push(t[s])}if(i&&!r[o].fn.apply(null,args))return delete t[n.name],!1}return delete t[n.name],!0}if(Object.keys(t).length===Object.keys(n).length)return e||this.allAssignments.push(o(t)),!0;var s=null;for(v in n){var u=!1;for(a in t)v===a&&(u=!0);if(!u){s=n[v];break}}for(var l in s.domain){var f=s.domain[l];if(i(s,f)){if(t[s.name]=f,this.solve(t,n,r,e)&&e)return!0;delete t[s.name]}}return!1},{DiscreteProblem:function(){return new r}}}function CspManager(){function t(t,n,e){var o=Csp().DiscreteProblem();for(var i in t.options)if(e&&i===e||!n.hasOwnProperty(i))o.addVariable(i,t.options[i]);else{var a=n[i];Array.isArray(a)?o.addVariable(i,a):o.addVariable(i,[a])}var s=r(t);return s.forEach(function(t){o.addConstraint(t.variables,t.funct)}),o}function n(t){for(var n in t)if(t.hasOwnProperty(n))return!1;return!0}function r(t){var n=[];return t.constraints.forEach(function(t){var r=t.properties.map(function(t,n){return"x"+n}).join(","),e="return ",o=t.relations.map(function(t){var n=t.map(function(t,n){return"boolean"==typeof t?"x"+n+"=="+t:isNaN(t)&&"!"==t.charAt(0)?"x"+n+"!=='"+t.slice(1)+"'":"x"+n+"=='"+t+"'"}).join(" && ");return"("+n+")"}).join("  || ");e+=o;var i=new Function(r,e);n.push({variables:t.properties,funct:i})}),n}this.getSolution=function(r,e,o){var i=t(r,e,o).getSolution();return n(i)?void 0:i},this.getSolutions=function(n,r,e){return t(n,r,e).getSolutions()},this.getValuesFor=function(t,n,r){for(var e=this.getSolutions(t,n,r),o=[],i=0;i<e.length;i++)o.indexOf(e[i][r])<0&&o.push(e[i][r]);return o},this.getSingleValueFor=function(t,n,r){var e=this.getSolution(t,n,r);if(e)return e[r]},this.checkCorrect=function(t,n){return void 0!==this.getSolution(t,n)}}angular.module("ngCsp",[]).factory("$csp",function(){"use strict";return new CspManager});